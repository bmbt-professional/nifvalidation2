{"{\"assumptions\":{},\"sourceRoot\":\"/Users/brunombteixeira/Coding/nifvalidation/server/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/brunombteixeira/Coding/nifvalidation/server\",\"filename\":\"/Users/brunombteixeira/Coding/nifvalidation/server/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/brunombteixeira/Coding/nifvalidation/server\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"// app.js\nconst express = require('express');\nconst app = express();\nconst cors = require('cors');\nconst {\n  API_KEY,\n  logPassword,\n  logUser,\n  firebaseConfig\n} = require('./config');\nconst {\n  Z_OK\n} = require('zlib');\n\n// Firebase\nimport firebase from \"firebase/compat/app\";\n// Required for side-effects\nimport \"firebase/firestore\";\nimport { initializeApp } from \"firebase/app\";\nimport { getFirestore } from \"firebase/firestore\";\nconst dbCon = initializeApp(firebaseConfig);\nconst db = initializeApp(firebaseConfig);\n\n// Puppeteer\nconst puppeteer = require('puppeteer-extra');\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth');\npuppeteer.use(StealthPlugin());\n\n// 2Captcha\nconst {\n  Solver\n} = require('2captcha');\nconst {\n  readFileSync\n} = require('fs');\nconst solver = new Solver(API_KEY);\napp.use(cors());\napp.get('/', (req, res) => {\n  res.json({\n    success: true,\n    message: 'welcome to the api'\n  });\n});\napp.get('/validate/:nif', (req, res) => {\n  const nif = req.params.nif;\n  try {\n    puppeteer.launch({\n      headless: true\n    }).then(async browser => {\n      const page = await browser.newPage();\n      await page.setViewport({\n        width: 1280,\n        height: 1024\n      });\n      await page.goto('https://www.portaldasfinancas.gov.pt/at/html/index.html', {\n        waitUntil: ['load', 'domcontentloaded']\n      });\n      try {\n        const element = await page.waitForSelector('.login > li:nth-child(2) > a');\n        await element.click();\n        await element.dispose();\n        const element2 = await page.waitForSelector('#content-area > div > div > label:nth-child(4)');\n        await element2.click();\n        await element2.dispose();\n        await page.type(\"#username\", logUser);\n        await page.type(\"#password-nif\", logPassword);\n        const element3 = await page.waitForSelector('#sbmtLogin');\n        await element3.click();\n        await element3.dispose();\n\n        // Open \"Identificação de Clientes/Fornecedores\" page\n        await page.goto('https://sitfiscal.portaldasfinancas.gov.pt/terceiros/clientefornecedores', {\n          waitUntil: ['load', 'domcontentloaded']\n        });\n        const element5 = await page.waitForSelector('#main-content > div > section > div > div > div > div:nth-child(2) > a');\n        await element5.click();\n        await element5.dispose();\n\n        //flagValidation = false\n        console.log('---------------------------');\n        console.log('NIF to be processed: ' + nif);\n\n        // Get text printscreen to use in validation\n        await page.waitForSelector('#main-content > form > div:nth-child(3) > div > div', {\n          waitUntil: ['load', 'domcontentloaded']\n        }); // wait for the selector to load\n        const screlement = await page.$('#main-content > form > div:nth-child(3) > div > div');\n        await screlement.screenshot({\n          path: 'captchanif.png'\n        }); // take screenshot element in puppeteer\n\n        try {\n          try {\n            const imageBase64File = await readFileSync('./captchanif.png', 'base64');\n            const response = await solver.imageCaptcha(imageBase64File);\n            await page.type(\"#nifCliente\", nif.toString());\n            await page.type(\"#respostaCaptcha\", response.data);\n            const element5 = await page.waitForSelector('#main-content > form > div:nth-child(2) > div > div.col-sm-4.col-xs-12 > div > button');\n            await element5.click();\n            await element5.dispose();\n            try {\n              await page.waitForSelector(\"#main-content > form > div:nth-child(3) > div > div > label.help-block.server-error-message\", {\n                timeout: 2000\n              });\n              await page.evaluate(() => document.getElementById(\"nifCliente\").value = \"\");\n              //console.log('Validation NOK - 1');\n              res.json({\n                success: false,\n                message: 'Validation without success 1'\n              });\n            } catch (error) {\n              await page.waitForTimeout(1000);\n              await page.screenshot({\n                path: \"./prints/\" + nif.toString() + \".png\",\n                fullPage: true\n              });\n\n              //flagValidation = true\n              const element5 = await page.waitForSelector('#main-content > div.row.align-right.margin-bottom > a');\n              await element5.click();\n              await element5.dispose();\n              res.json({\n                success: true,\n                message: 'Validation succeded'\n              });\n              await browser.close();\n            }\n          } catch (error) {\n            res.json({\n              success: false,\n              message: 'Validation without success 2'\n            });\n            await browser.close();\n          }\n        } catch (error) {\n          console.log(error);\n          res.json({\n            success: false,\n            message: 'Validation without success 3'\n          });\n          await browser.close();\n        }\n        await browser.close();\n        res.json({\n          success: true,\n          message: 'Login with success'\n        });\n      } catch {\n        res.json({\n          success: false,\n          message: 'Login has failed'\n        });\n      }\n      res.json({\n        message: 'Proccess completed'\n      });\n    });\n  } catch {\n    res.json({\n      success: false,\n      message: 'The process failed'\n    });\n  }\n});\napp.get('/test', async (req, res) => {\n  try {\n    const testJson = {\n      name: \"Test Name\",\n      description: \"Test Description\"\n    };\n    admin.database().ref('/test').push(testJson).then(snapshot => {\n      res.status(201).json({\n        id: snapshot.key\n      });\n    }).catch(error => {\n      res.status(500).json({\n        error: error.message\n      });\n    });\n  } catch (error) {\n    res.send(error);\n  }\n});\napp.listen(3000, () => {\n  console.log('API Running on http://localhost:3000');\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImFwcCIsImNvcnMiLCJBUElfS0VZIiwibG9nUGFzc3dvcmQiLCJsb2dVc2VyIiwiZmlyZWJhc2VDb25maWciLCJaX09LIiwiZmlyZWJhc2UiLCJpbml0aWFsaXplQXBwIiwiZ2V0RmlyZXN0b3JlIiwiZGJDb24iLCJkYiIsInB1cHBldGVlciIsIlN0ZWFsdGhQbHVnaW4iLCJ1c2UiLCJTb2x2ZXIiLCJyZWFkRmlsZVN5bmMiLCJzb2x2ZXIiLCJnZXQiLCJyZXEiLCJyZXMiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJuaWYiLCJwYXJhbXMiLCJsYXVuY2giLCJoZWFkbGVzcyIsInRoZW4iLCJicm93c2VyIiwicGFnZSIsIm5ld1BhZ2UiLCJzZXRWaWV3cG9ydCIsIndpZHRoIiwiaGVpZ2h0IiwiZ290byIsIndhaXRVbnRpbCIsImVsZW1lbnQiLCJ3YWl0Rm9yU2VsZWN0b3IiLCJjbGljayIsImRpc3Bvc2UiLCJlbGVtZW50MiIsInR5cGUiLCJlbGVtZW50MyIsImVsZW1lbnQ1IiwiY29uc29sZSIsImxvZyIsInNjcmVsZW1lbnQiLCIkIiwic2NyZWVuc2hvdCIsInBhdGgiLCJpbWFnZUJhc2U2NEZpbGUiLCJyZXNwb25zZSIsImltYWdlQ2FwdGNoYSIsInRvU3RyaW5nIiwiZGF0YSIsInRpbWVvdXQiLCJldmFsdWF0ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsImVycm9yIiwid2FpdEZvclRpbWVvdXQiLCJmdWxsUGFnZSIsImNsb3NlIiwidGVzdEpzb24iLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJhZG1pbiIsImRhdGFiYXNlIiwicmVmIiwicHVzaCIsInNuYXBzaG90Iiwic3RhdHVzIiwiaWQiLCJrZXkiLCJjYXRjaCIsInNlbmQiLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9icnVub21idGVpeGVpcmEvQ29kaW5nL25pZnZhbGlkYXRpb24vc2VydmVyLyIsInNvdXJjZXMiOlsiYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGFwcC5qc1xuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKVxuY29uc3QgYXBwID0gZXhwcmVzcygpXG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpXG5jb25zdCB7IEFQSV9LRVksIGxvZ1Bhc3N3b3JkLCBsb2dVc2VyLCBmaXJlYmFzZUNvbmZpZyB9ID0gcmVxdWlyZSgnLi9jb25maWcnKTtcbmNvbnN0IHsgWl9PSyB9ID0gcmVxdWlyZSgnemxpYicpXG5cbi8vIEZpcmViYXNlXG5pbXBvcnQgZmlyZWJhc2UgZnJvbSBcImZpcmViYXNlL2NvbXBhdC9hcHBcIjtcbi8vIFJlcXVpcmVkIGZvciBzaWRlLWVmZmVjdHNcbmltcG9ydCBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5pbXBvcnQgeyBpbml0aWFsaXplQXBwIH0gZnJvbSBcImZpcmViYXNlL2FwcFwiO1xuaW1wb3J0IHsgZ2V0RmlyZXN0b3JlIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5jb25zdCBkYkNvbiA9IGluaXRpYWxpemVBcHAoZmlyZWJhc2VDb25maWcpO1xuY29uc3QgZGIgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKVxuXG4vLyBQdXBwZXRlZXJcbmNvbnN0IHB1cHBldGVlciA9IHJlcXVpcmUoJ3B1cHBldGVlci1leHRyYScpXG5jb25zdCBTdGVhbHRoUGx1Z2luID0gcmVxdWlyZSgncHVwcGV0ZWVyLWV4dHJhLXBsdWdpbi1zdGVhbHRoJylcbnB1cHBldGVlci51c2UoU3RlYWx0aFBsdWdpbigpKVxuXG4vLyAyQ2FwdGNoYVxuY29uc3QgeyBTb2x2ZXIgfSA9IHJlcXVpcmUoJzJjYXB0Y2hhJyk7XG5jb25zdCB7IHJlYWRGaWxlU3luYyB9ID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHNvbHZlciA9IG5ldyBTb2x2ZXIoQVBJX0tFWSk7XG5cbmFwcC51c2UoY29ycygpKVxuYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ3dlbGNvbWUgdG8gdGhlIGFwaScgfSlcbn0pXG5hcHAuZ2V0KCcvdmFsaWRhdGUvOm5pZicsIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IG5pZiA9IHJlcS5wYXJhbXMubmlmXG4gICAgdHJ5IHtcbiAgICAgICAgcHVwcGV0ZWVyLmxhdW5jaCh7IGhlYWRsZXNzOiB0cnVlIH0pLnRoZW4oYXN5bmMgYnJvd3NlciA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKClcbiAgICAgICAgICAgIGF3YWl0IHBhZ2Uuc2V0Vmlld3BvcnQoeyB3aWR0aDogMTI4MCwgaGVpZ2h0OiAxMDI0IH0pO1xuICAgICAgICAgICAgYXdhaXQgcGFnZS5nb3RvKCdodHRwczovL3d3dy5wb3J0YWxkYXNmaW5hbmNhcy5nb3YucHQvYXQvaHRtbC9pbmRleC5odG1sJywgeyB3YWl0VW50aWw6IFsnbG9hZCcsICdkb21jb250ZW50bG9hZGVkJ10gfSlcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3IoJy5sb2dpbiA+IGxpOm50aC1jaGlsZCgyKSA+IGEnKVxuICAgICAgICAgICAgICAgIGF3YWl0IGVsZW1lbnQuY2xpY2soKVxuICAgICAgICAgICAgICAgIGF3YWl0IGVsZW1lbnQuZGlzcG9zZSgpXG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudDIgPSBhd2FpdCBwYWdlLndhaXRGb3JTZWxlY3RvcignI2NvbnRlbnQtYXJlYSA+IGRpdiA+IGRpdiA+IGxhYmVsOm50aC1jaGlsZCg0KScpXG4gICAgICAgICAgICAgICAgYXdhaXQgZWxlbWVudDIuY2xpY2soKVxuICAgICAgICAgICAgICAgIGF3YWl0IGVsZW1lbnQyLmRpc3Bvc2UoKVxuICAgICAgICAgICAgICAgIGF3YWl0IHBhZ2UudHlwZShcIiN1c2VybmFtZVwiLCBsb2dVc2VyKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBwYWdlLnR5cGUoXCIjcGFzc3dvcmQtbmlmXCIsIGxvZ1Bhc3N3b3JkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50MyA9IGF3YWl0IHBhZ2Uud2FpdEZvclNlbGVjdG9yKCcjc2JtdExvZ2luJylcbiAgICAgICAgICAgICAgICBhd2FpdCBlbGVtZW50My5jbGljaygpXG4gICAgICAgICAgICAgICAgYXdhaXQgZWxlbWVudDMuZGlzcG9zZSgpXG5cbiAgICAgICAgICAgICAgICAvLyBPcGVuIFwiSWRlbnRpZmljYcOnw6NvIGRlIENsaWVudGVzL0Zvcm5lY2Vkb3Jlc1wiIHBhZ2VcbiAgICAgICAgICAgICAgICBhd2FpdCBwYWdlLmdvdG8oJ2h0dHBzOi8vc2l0ZmlzY2FsLnBvcnRhbGRhc2ZpbmFuY2FzLmdvdi5wdC90ZXJjZWlyb3MvY2xpZW50ZWZvcm5lY2Vkb3JlcycsIHsgd2FpdFVudGlsOiBbJ2xvYWQnLCAnZG9tY29udGVudGxvYWRlZCddIH0pXG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudDUgPSBhd2FpdCBwYWdlLndhaXRGb3JTZWxlY3RvcignI21haW4tY29udGVudCA+IGRpdiA+IHNlY3Rpb24gPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXY6bnRoLWNoaWxkKDIpID4gYScpXG4gICAgICAgICAgICAgICAgYXdhaXQgZWxlbWVudDUuY2xpY2soKVxuICAgICAgICAgICAgICAgIGF3YWl0IGVsZW1lbnQ1LmRpc3Bvc2UoKVxuXG4gICAgICAgICAgICAgICAgLy9mbGFnVmFsaWRhdGlvbiA9IGZhbHNlXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOSUYgdG8gYmUgcHJvY2Vzc2VkOiAnICsgbmlmKTtcblxuICAgICAgICAgICAgICAgIC8vIEdldCB0ZXh0IHByaW50c2NyZWVuIHRvIHVzZSBpbiB2YWxpZGF0aW9uXG4gICAgICAgICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3IoJyNtYWluLWNvbnRlbnQgPiBmb3JtID4gZGl2Om50aC1jaGlsZCgzKSA+IGRpdiA+IGRpdicsIHsgd2FpdFVudGlsOiBbJ2xvYWQnLCAnZG9tY29udGVudGxvYWRlZCddIH0pOyAgICAgICAgICAvLyB3YWl0IGZvciB0aGUgc2VsZWN0b3IgdG8gbG9hZFxuICAgICAgICAgICAgICAgIGNvbnN0IHNjcmVsZW1lbnQgPSBhd2FpdCBwYWdlLiQoJyNtYWluLWNvbnRlbnQgPiBmb3JtID4gZGl2Om50aC1jaGlsZCgzKSA+IGRpdiA+IGRpdicpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHNjcmVsZW1lbnQuc2NyZWVuc2hvdCh7IHBhdGg6ICdjYXB0Y2hhbmlmLnBuZycgfSk7IC8vIHRha2Ugc2NyZWVuc2hvdCBlbGVtZW50IGluIHB1cHBldGVlclxuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGltYWdlQmFzZTY0RmlsZSA9IGF3YWl0IHJlYWRGaWxlU3luYygnLi9jYXB0Y2hhbmlmLnBuZycsICdiYXNlNjQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc29sdmVyLmltYWdlQ2FwdGNoYShpbWFnZUJhc2U2NEZpbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGFnZS50eXBlKFwiI25pZkNsaWVudGVcIiwgbmlmLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGFnZS50eXBlKFwiI3Jlc3Bvc3RhQ2FwdGNoYVwiLCByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQ1ID0gYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3IoJyNtYWluLWNvbnRlbnQgPiBmb3JtID4gZGl2Om50aC1jaGlsZCgyKSA+IGRpdiA+IGRpdi5jb2wtc20tNC5jb2wteHMtMTIgPiBkaXYgPiBidXR0b24nKVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZWxlbWVudDUuY2xpY2soKVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZWxlbWVudDUuZGlzcG9zZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHBhZ2Uud2FpdEZvclNlbGVjdG9yKFwiI21haW4tY29udGVudCA+IGZvcm0gPiBkaXY6bnRoLWNoaWxkKDMpID4gZGl2ID4gZGl2ID4gbGFiZWwuaGVscC1ibG9jay5zZXJ2ZXItZXJyb3ItbWVzc2FnZVwiLCB7IHRpbWVvdXQ6IDIwMDAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmlmQ2xpZW50ZVwiKS52YWx1ZSA9IFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnVmFsaWRhdGlvbiBOT0sgLSAxJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1ZhbGlkYXRpb24gd2l0aG91dCBzdWNjZXNzIDEnIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHBhZ2Uud2FpdEZvclRpbWVvdXQoMTAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwYWdlLnNjcmVlbnNob3QoeyBwYXRoOiBcIi4vcHJpbnRzL1wiICsgbmlmLnRvU3RyaW5nKCkgKyBcIi5wbmdcIiwgZnVsbFBhZ2U6IHRydWUgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZmxhZ1ZhbGlkYXRpb24gPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudDUgPSBhd2FpdCBwYWdlLndhaXRGb3JTZWxlY3RvcignI21haW4tY29udGVudCA+IGRpdi5yb3cuYWxpZ24tcmlnaHQubWFyZ2luLWJvdHRvbSA+IGEnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGVsZW1lbnQ1LmNsaWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBlbGVtZW50NS5kaXNwb3NlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIHN1Y2NlZGVkJyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1ZhbGlkYXRpb24gd2l0aG91dCBzdWNjZXNzIDInIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1ZhbGlkYXRpb24gd2l0aG91dCBzdWNjZXNzIDMnIH0pXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKVxuICAgICAgICAgICAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ0xvZ2luIHdpdGggc3VjY2VzcycgfSlcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdMb2dpbiBoYXMgZmFpbGVkJyB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzLmpzb24oeyBtZXNzYWdlOiAnUHJvY2Nlc3MgY29tcGxldGVkJyB9KVxuICAgICAgICB9KVxuICAgIH0gY2F0Y2gge1xuICAgICAgICByZXMuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnVGhlIHByb2Nlc3MgZmFpbGVkJyB9KVxuICAgIH1cbn0pXG5hcHAuZ2V0KCcvdGVzdCcsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHRlc3RKc29uID0ge1xuICAgICAgICAgICAgbmFtZTogXCJUZXN0IE5hbWVcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRlc3QgRGVzY3JpcHRpb25cIixcbiAgICAgICAgfTtcbiAgICAgICAgYWRtaW4uZGF0YWJhc2UoKS5yZWYoJy90ZXN0JykucHVzaCh0ZXN0SnNvbilcbiAgICAgICAgICAgIC50aGVuKHNuYXBzaG90ID0+IHtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7IGlkOiBzbmFwc2hvdC5rZXkgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnNlbmQoZXJyb3IpXG4gICAgfVxufSlcbmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4geyBjb25z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","map":{"version":3,"names":["express","require","app","cors","API_KEY","logPassword","logUser","firebaseConfig","Z_OK","firebase","initializeApp","getFirestore","dbCon","db","puppeteer","StealthPlugin","use","Solver","readFileSync","solver","get","req","res","json","success","message","nif","params","launch","headless","then","browser","page","newPage","setViewport","width","height","goto","waitUntil","element","waitForSelector","click","dispose","element2","type","element3","element5","console","log","screlement","$","screenshot","path","imageBase64File","response","imageCaptcha","toString","data","timeout","evaluate","document","getElementById","value","error","waitForTimeout","fullPage","close","testJson","name","description","admin","database","ref","push","snapshot","status","id","key","catch","send","listen"],"sourceRoot":"/Users/brunombteixeira/Coding/nifvalidation/server/","sources":["app.js"],"sourcesContent":["// app.js\nconst express = require('express')\nconst app = express()\nconst cors = require('cors')\nconst { API_KEY, logPassword, logUser, firebaseConfig } = require('./config');\nconst { Z_OK } = require('zlib')\n\n// Firebase\nimport firebase from \"firebase/compat/app\";\n// Required for side-effects\nimport \"firebase/firestore\";\n\nimport { initializeApp } from \"firebase/app\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst dbCon = initializeApp(firebaseConfig);\nconst db = initializeApp(firebaseConfig)\n\n// Puppeteer\nconst puppeteer = require('puppeteer-extra')\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\npuppeteer.use(StealthPlugin())\n\n// 2Captcha\nconst { Solver } = require('2captcha');\nconst { readFileSync } = require('fs');\nconst solver = new Solver(API_KEY);\n\napp.use(cors())\napp.get('/', (req, res) => {\n    res.json({ success: true, message: 'welcome to the api' })\n})\napp.get('/validate/:nif', (req, res) => {\n    const nif = req.params.nif\n    try {\n        puppeteer.launch({ headless: true }).then(async browser => {\n            const page = await browser.newPage()\n            await page.setViewport({ width: 1280, height: 1024 });\n            await page.goto('https://www.portaldasfinancas.gov.pt/at/html/index.html', { waitUntil: ['load', 'domcontentloaded'] })\n\n            try {\n                const element = await page.waitForSelector('.login > li:nth-child(2) > a')\n                await element.click()\n                await element.dispose()\n                const element2 = await page.waitForSelector('#content-area > div > div > label:nth-child(4)')\n                await element2.click()\n                await element2.dispose()\n                await page.type(\"#username\", logUser);\n                await page.type(\"#password-nif\", logPassword);\n                const element3 = await page.waitForSelector('#sbmtLogin')\n                await element3.click()\n                await element3.dispose()\n\n                // Open \"Identificação de Clientes/Fornecedores\" page\n                await page.goto('https://sitfiscal.portaldasfinancas.gov.pt/terceiros/clientefornecedores', { waitUntil: ['load', 'domcontentloaded'] })\n                const element5 = await page.waitForSelector('#main-content > div > section > div > div > div > div:nth-child(2) > a')\n                await element5.click()\n                await element5.dispose()\n\n                //flagValidation = false\n                console.log('---------------------------');\n                console.log('NIF to be processed: ' + nif);\n\n                // Get text printscreen to use in validation\n                await page.waitForSelector('#main-content > form > div:nth-child(3) > div > div', { waitUntil: ['load', 'domcontentloaded'] });          // wait for the selector to load\n                const screlement = await page.$('#main-content > form > div:nth-child(3) > div > div');\n                await screlement.screenshot({ path: 'captchanif.png' }); // take screenshot element in puppeteer\n\n                try {\n                    try {\n                        const imageBase64File = await readFileSync('./captchanif.png', 'base64');\n                        const response = await solver.imageCaptcha(imageBase64File);\n                        await page.type(\"#nifCliente\", nif.toString());\n                        await page.type(\"#respostaCaptcha\", response.data);\n                        const element5 = await page.waitForSelector('#main-content > form > div:nth-child(2) > div > div.col-sm-4.col-xs-12 > div > button')\n                        await element5.click()\n                        await element5.dispose()\n                        try {\n                            await page.waitForSelector(\"#main-content > form > div:nth-child(3) > div > div > label.help-block.server-error-message\", { timeout: 2000 })\n                            await page.evaluate(() => document.getElementById(\"nifCliente\").value = \"\")\n                            //console.log('Validation NOK - 1');\n                            res.json({ success: false, message: 'Validation without success 1' })\n                        } catch (error) {\n                            await page.waitForTimeout(1000)\n                            await page.screenshot({ path: \"./prints/\" + nif.toString() + \".png\", fullPage: true })\n\n                            //flagValidation = true\n                            const element5 = await page.waitForSelector('#main-content > div.row.align-right.margin-bottom > a')\n                            await element5.click()\n                            await element5.dispose()\n                            res.json({ success: true, message: 'Validation succeded' })\n                            await browser.close()\n                        }\n                    } catch (error) {\n                        res.json({ success: false, message: 'Validation without success 2' })\n                        await browser.close()\n                    }\n                } catch (error) {\n                    console.log(error);\n                    res.json({ success: false, message: 'Validation without success 3' })\n                    await browser.close()\n                }\n\n                await browser.close()\n                res.json({ success: true, message: 'Login with success' })\n            } catch {\n                res.json({ success: false, message: 'Login has failed' })\n            }\n            res.json({ message: 'Proccess completed' })\n        })\n    } catch {\n        res.json({ success: false, message: 'The process failed' })\n    }\n})\napp.get('/test', async (req, res) => {\n    try {\n        const testJson = {\n            name: \"Test Name\",\n            description: \"Test Description\",\n        };\n        admin.database().ref('/test').push(testJson)\n            .then(snapshot => {\n                res.status(201).json({ id: snapshot.key });\n            })\n            .catch(error => {\n                res.status(500).json({ error: error.message });\n            });\n    } catch (error) {\n        res.send(error)\n    }\n})\napp.listen(3000, () => { console.log('API Running on http://localhost:3000') })"],"mappings":"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"}},"mtime":1700178765439},"{\"assumptions\":{},\"sourceRoot\":\"/Users/brunombteixeira/Coding/nifvalidation/server/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/brunombteixeira/Coding/nifvalidation/server\",\"filename\":\"/Users/brunombteixeira/Coding/nifvalidation/server/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/brunombteixeira/Coding/nifvalidation/server\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"const API_KEY = 'cce84dc9f0393acd5cb4144135be78bf';\nconst logUser = \"113252439\";\nconst logPassword = \"GZ84Q59D3PPQ\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyARnVSaXh7JeBKvS3XIGsludad1Rx1kcl0\",\n  authDomain: \"nifsvalidation.firebaseapp.com\",\n  databaseURL: \"https://nifsvalidation-default-rtdb.europe-west1.firebasedatabase.app\",\n  projectId: \"nifsvalidation\",\n  storageBucket: \"nifsvalidation.appspot.com\",\n  messagingSenderId: \"777614856953\",\n  appId: \"1:777614856953:web:66e1d7a1baca7af4d8c828\"\n};\nmodule.exports = {\n  API_KEY,\n  logUser,\n  logPassword,\n  firebaseConfig\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBUElfS0VZIiwibG9nVXNlciIsImxvZ1Bhc3N3b3JkIiwiZmlyZWJhc2VDb25maWciLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwiZGF0YWJhc2VVUkwiLCJwcm9qZWN0SWQiLCJzdG9yYWdlQnVja2V0IiwibWVzc2FnaW5nU2VuZGVySWQiLCJhcHBJZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9icnVub21idGVpeGVpcmEvQ29kaW5nL25pZnZhbGlkYXRpb24vc2VydmVyLyIsInNvdXJjZXMiOlsiY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFQSV9LRVkgPSAnY2NlODRkYzlmMDM5M2FjZDVjYjQxNDQxMzViZTc4YmYnO1xuY29uc3QgbG9nVXNlciA9IFwiMTEzMjUyNDM5XCI7XG5jb25zdCBsb2dQYXNzd29yZCA9IFwiR1o4NFE1OUQzUFBRXCI7XG5jb25zdCBmaXJlYmFzZUNvbmZpZyA9IHtcbiAgICBhcGlLZXk6IFwiQUl6YVN5QVJuVlNhWGg3SmVCS3ZTM1hJR3NsdWRhZDFSeDFrY2wwXCIsXG4gICAgYXV0aERvbWFpbjogXCJuaWZzdmFsaWRhdGlvbi5maXJlYmFzZWFwcC5jb21cIixcbiAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL25pZnN2YWxpZGF0aW9uLWRlZmF1bHQtcnRkYi5ldXJvcGUtd2VzdDEuZmlyZWJhc2VkYXRhYmFzZS5hcHBcIixcbiAgICBwcm9qZWN0SWQ6IFwibmlmc3ZhbGlkYXRpb25cIixcbiAgICBzdG9yYWdlQnVja2V0OiBcIm5pZnN2YWxpZGF0aW9uLmFwcHNwb3QuY29tXCIsXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IFwiNzc3NjE0ODU2OTUzXCIsXG4gICAgYXBwSWQ6IFwiMTo3Nzc2MTQ4NTY5NTM6d2ViOjY2ZTFkN2ExYmFjYTdhZjRkOGM4MjhcIlxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBBUElfS0VZLFxuICAgIGxvZ1VzZXIsXG4gICAgbG9nUGFzc3dvcmQsXG4gICAgZmlyZWJhc2VDb25maWdcbn0iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBRyxrQ0FBa0M7QUFDbEQsTUFBTUMsT0FBTyxHQUFHLFdBQVc7QUFDM0IsTUFBTUMsV0FBVyxHQUFHLGNBQWM7QUFDbEMsTUFBTUMsY0FBYyxHQUFHO0VBQ25CQyxNQUFNLEVBQUUseUNBQXlDO0VBQ2pEQyxVQUFVLEVBQUUsZ0NBQWdDO0VBQzVDQyxXQUFXLEVBQUUsdUVBQXVFO0VBQ3BGQyxTQUFTLEVBQUUsZ0JBQWdCO0VBQzNCQyxhQUFhLEVBQUUsNEJBQTRCO0VBQzNDQyxpQkFBaUIsRUFBRSxjQUFjO0VBQ2pDQyxLQUFLLEVBQUU7QUFDWCxDQUFDO0FBR0RDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2JaLE9BQU87RUFDUEMsT0FBTztFQUNQQyxXQUFXO0VBQ1hDO0FBQ0osQ0FBQyJ9","map":{"version":3,"names":["API_KEY","logUser","logPassword","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","module","exports"],"sourceRoot":"/Users/brunombteixeira/Coding/nifvalidation/server/","sources":["config.js"],"sourcesContent":["const API_KEY = 'cce84dc9f0393acd5cb4144135be78bf';\nconst logUser = \"113252439\";\nconst logPassword = \"GZ84Q59D3PPQ\";\nconst firebaseConfig = {\n    apiKey: \"AIzaSyARnVSaXh7JeBKvS3XIGsludad1Rx1kcl0\",\n    authDomain: \"nifsvalidation.firebaseapp.com\",\n    databaseURL: \"https://nifsvalidation-default-rtdb.europe-west1.firebasedatabase.app\",\n    projectId: \"nifsvalidation\",\n    storageBucket: \"nifsvalidation.appspot.com\",\n    messagingSenderId: \"777614856953\",\n    appId: \"1:777614856953:web:66e1d7a1baca7af4d8c828\"\n};\n\n\nmodule.exports = {\n    API_KEY,\n    logUser,\n    logPassword,\n    firebaseConfig\n}"],"mappings":"AAAA,MAAMA,OAAO,GAAG,kCAAkC;AAClD,MAAMC,OAAO,GAAG,WAAW;AAC3B,MAAMC,WAAW,GAAG,cAAc;AAClC,MAAMC,cAAc,GAAG;EACnBC,MAAM,EAAE,yCAAyC;EACjDC,UAAU,EAAE,gCAAgC;EAC5CC,WAAW,EAAE,uEAAuE;EACpFC,SAAS,EAAE,gBAAgB;EAC3BC,aAAa,EAAE,4BAA4B;EAC3CC,iBAAiB,EAAE,cAAc;EACjCC,KAAK,EAAE;AACX,CAAC;AAGDC,MAAM,CAACC,OAAO,GAAG;EACbZ,OAAO;EACPC,OAAO;EACPC,WAAW;EACXC;AACJ,CAAC"}},"mtime":1700177537556}}